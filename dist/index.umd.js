!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@bsv/sdk"),require("sigma-protocol")):"function"==typeof define&&define.amd?define(["exports","@bsv/sdk","sigma-protocol"],r):r((n||self).js1SatOrd={},n.bsv,n.sigmaProtocol)}(this,function(n,r,t){function e(n,r){(null==r||r>n.length)&&(r=n.length);for(var t=0,e=Array(r);t<r;t++)e[t]=n[t];return e}function o(n,r){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=function(n,r){if(n){if("string"==typeof n)return e(n,r);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?e(n,r):void 0}}(n))||r&&n&&"number"==typeof n.length){t&&(n=t);var o=0;return function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(){return i=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var e in t)({}).hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},i.apply(null,arguments)}function a(n,r){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},a(n,r)}var s=function(n){for(var r=[],t=0,e=n.length;t<e;t++){var o=Number(n.charCodeAt(t)).toString(16);r.push(o)}return r.join("")},u=/*#__PURE__*/function(n){function t(){return n.apply(this,arguments)||this}var e,o;return o=n,(e=t).prototype=Object.create(o.prototype),e.prototype.constructor=e,a(e,o),t.prototype.lock=function(n,t,e,o){var i="";if(void 0!==t&&void 0!==e){var a=s("ord"),u=Buffer.from(t,"base64").toString("hex").trim();if(!u)throw new Error("Invalid file data");var c=s(e);if(!c)throw new Error("Invalid media type");i="OP_0 OP_IF "+a+" OP_1 "+c+" OP_0 "+u+" OP_ENDIF"}var l=(i?i+" ":"")+(new r.P2PKH).lock(n).toASM();if(o&&(!o.app||!o.type))throw new Error("MAP.app and MAP.type are required fields");if(null!=o&&o.app&&null!=o&&o.type){l=l+" OP_RETURN "+s("1PuQa7K62MiKCtssSLKy1kh56WWU7MtUR5")+" "+s("SET");for(var d=0,f=Object.entries(o);d<f.length;d++){var p=f[d],v=p[0],h=p[1];"cmd"!==v&&(l=l+" "+s(v)+" "+s(h))}}return r.LockingScript.fromASM(l)},t}(r.P2PKH),c=function(n,t){var e=r.fromUtxo(i({},n,{script:Buffer.from(n.script,"base64").toString("hex")}),t);return e.sourceTXID=n.txid,e};n.createOrdinals=function(n,e,i,a,s,l,d,f){void 0===s&&(s=10),void 0===f&&(f=[]);try{for(var p,v=function(n){return Promise.resolve(g.fee(h)).then(function(){return Promise.resolve(g.sign()).then(function(){return g})})},h=new r.SatoshisPerKilobyte(s),g=new r.Transaction,P=o(n);!(p=P()).done;){var m=c(p.value,(new r.P2PKH).unlock(i));g.addInput(m)}e.length>100&&console.warn("Creating many inscriptions at once can be slow. Consider using multiple transactions instead.");for(var y,w=o(e);!(y=w()).done;){var b=y.value;if(!b.inscription)throw new Error("Inscription is required for all destinations");g.addOutput({satoshis:1,lockingScript:(new u).lock(b.address,b.inscription.dataB64,b.inscription.contentType,l)})}for(var k,S=o(f);!(k=S()).done;){var O=k.value;g.addOutput({satoshis:O.amount,lockingScript:(new r.P2PKH).lock(O.to)})}g.addOutput({lockingScript:(new r.P2PKH).lock(a),change:!0});var K=null==d?void 0:d.idKey,T=null==d?void 0:d.keyHost,j=function(){if(!K)return function(){if(T){var n=null==d?void 0:d.authToken,r=new t.Sigma(g);return function(t,e){try{var o=Promise.resolve(r.remoteSign(T,n)).then(function(n){g=n.signedTx})}catch(n){return e(n)}return o&&o.then?o.then(void 0,e):o}(0,function(n){throw console.log(n),new Error("Remote signing to "+T+" failed")})}}();var n=new t.Sigma(g).sign(K);g=n.signedTx}();return Promise.resolve(j&&j.then?j.then(v):v())}catch(n){return Promise.reject(n)}},n.sendOrdinals=function(n,t,e,i,a,s,l,d,f){void 0===l&&(l=10),void 0===f&&(f=[]);try{for(var p,v=new r.SatoshisPerKilobyte(l),h=new r.Transaction,g=o(t);!(p=g()).done;){var P=c(p.value,(new u).unlock(a));h.addInput(P)}for(var m,y=o(n);!(m=y()).done;){var w=c(m.value,(new r.P2PKH).unlock(e));h.addInput(w)}if(s.length!==t.length)throw new Error("Number of destinations must match number of ordinals being sent");for(var b,k=o(s);!(b=k()).done;){var S,O,K,T=b.value;K=null!=(S=T.inscription)&&S.dataB64&&null!=(O=T.inscription)&&O.contentType?(new u).lock(T.address,T.inscription.dataB64,T.inscription.contentType,d):(new r.P2PKH).lock(T.address),h.addOutput({satoshis:1,lockingScript:K})}for(var j,H=o(f);!(j=H()).done;){var I=j.value;h.addOutput({satoshis:I.amount,lockingScript:(new r.P2PKH).lock(I.to)})}var A=(new r.P2PKH).lock(i);return h.addOutput({lockingScript:A,change:!0}),Promise.resolve(h.fee(v)).then(function(){return Promise.resolve(h.sign()).then(function(){return h})})}catch(n){return Promise.reject(n)}},n.sendUtxos=function(n,t,e,i,a){void 0===a&&(a=10);try{for(var s,u=new r.SatoshisPerKilobyte(a),l=new r.Transaction,d=o(n);!(s=d()).done;){var f=c(s.value,(new r.P2PKH).unlock(t));l.addInput(f)}var p={satoshis:i,lockingScript:(new r.P2PKH).lock(e)};l.addOutput(p);var v=t.toAddress().toString(),h=(new r.P2PKH).lock(v);return l.addOutput({lockingScript:h,change:!0}),Promise.resolve(l.fee(u)).then(function(){return Promise.resolve(l.sign()).then(function(){return l})})}catch(n){return Promise.reject(n)}}});
//# sourceMappingURL=index.umd.js.map
