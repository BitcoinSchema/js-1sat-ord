!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@bsv/sdk"),require("fs"),require("path"),require("os"),require("crypto")):"function"==typeof define&&define.amd?define(["exports","@bsv/sdk","fs","path","os","crypto"],t):t((e||self).js1SatOrd={},e.sdk,e.fs,e.path,e.os,e.crypto)}(this,function(e,t,n,r,o,s){function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=/*#__PURE__*/c(n),i=/*#__PURE__*/c(r),u=/*#__PURE__*/c(o),l=/*#__PURE__*/c(s);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}const d="16.4.5",v=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function h(e){console.log(`[dotenv@${d}][DEBUG] ${e}`)}function g(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function E(e,t){let n;try{n=new URL(t)}catch(e){if("ERR_INVALID_URL"===e.code){const e=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw e.code="INVALID_DOTENV_KEY",e}throw e}const r=n.password;if(!r){const e=new Error("INVALID_DOTENV_KEY: Missing key part");throw e.code="INVALID_DOTENV_KEY",e}const o=n.searchParams.get("environment");if(!o){const e=new Error("INVALID_DOTENV_KEY: Missing environment part");throw e.code="INVALID_DOTENV_KEY",e}const s=`DOTENV_VAULT_${o.toUpperCase()}`,c=e.parsed[s];if(!c){const e=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${s} in your .env.vault file.`);throw e.code="NOT_FOUND_DOTENV_ENVIRONMENT",e}return{ciphertext:c,key:r}}function y(e){let t=null;if(e&&e.path&&e.path.length>0)if(Array.isArray(e.path))for(const n of e.path)a.default.existsSync(n)&&(t=n.endsWith(".vault")?n:`${n}.vault`);else t=e.path.endsWith(".vault")?e.path:`${e.path}.vault`;else t=i.default.resolve(process.cwd(),".env.vault");return a.default.existsSync(t)?t:null}function _(e){return"~"===e[0]?i.default.join(u.default.homedir(),e.slice(1)):e}const m={configDotenv:function(e){const t=i.default.resolve(process.cwd(),".env");let n="utf8";const r=Boolean(e&&e.debug);e&&e.encoding?n=e.encoding:r&&h("No encoding is specified. UTF-8 is used by default");let o,s=[t];if(e&&e.path)if(Array.isArray(e.path)){s=[];for(const t of e.path)s.push(_(t))}else s=[_(e.path)];const c={};for(const t of s)try{const r=m.parse(a.default.readFileSync(t,{encoding:n}));m.populate(c,r,e)}catch(e){r&&h(`Failed to load ${t} ${e.message}`),o=e}let u=process.env;return e&&null!=e.processEnv&&(u=e.processEnv),m.populate(u,c,e),o?{parsed:c,error:o}:{parsed:c}},_configVault:function(e){console.log(`[dotenv@${d}][INFO] Loading env from encrypted .env.vault`);const t=m._parseVault(e);let n=process.env;return e&&null!=e.processEnv&&(n=e.processEnv),m.populate(n,t,e),{parsed:t}},_parseVault:function(e){const t=y(e),n=m.configDotenv({path:t});if(!n.parsed){const e=new Error(`MISSING_DATA: Cannot parse ${t} for an unknown reason`);throw e.code="MISSING_DATA",e}const r=g(e).split(","),o=r.length;let s;for(let e=0;e<o;e++)try{const t=E(n,r[e].trim());s=m.decrypt(t.ciphertext,t.key);break}catch(t){if(e+1>=o)throw t}return m.parse(s)},config:function(e){if(0===g(e).length)return m.configDotenv(e);const t=y(e);return t?m._configVault(e):(console.log(`[dotenv@${d}][WARN] You set DOTENV_KEY but you are missing a .env.vault file at ${t}. Did you forget to build it?`),m.configDotenv(e))},decrypt:function(e,t){const n=Buffer.from(t.slice(-64),"hex");let r=Buffer.from(e,"base64");const o=r.subarray(0,12),s=r.subarray(-16);r=r.subarray(12,-16);try{const e=l.default.createDecipheriv("aes-256-gcm",n,o);return e.setAuthTag(s),`${e.update(r)}${e.final()}`}catch(e){const t=e instanceof RangeError,n="Unsupported state or unable to authenticate data"===e.message;if(t||"Invalid key length"===e.message){const e=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw e.code="INVALID_DOTENV_KEY",e}if(n){const e=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw e.code="DECRYPTION_FAILED",e}throw e}},parse:function(e){const t={};let n,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(n=v.exec(r));){const e=n[1];let r=n[2]||"";r=r.trim();const o=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===o&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),t[e]=r}return t},populate:function(e,t,n={}){const r=Boolean(n&&n.debug),o=Boolean(n&&n.override);if("object"!=typeof t){const e=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw e.code="OBJECT_REQUIRED",e}for(const n of Object.keys(t))Object.prototype.hasOwnProperty.call(e,n)?(!0===o&&(e[n]=t[n]),r&&h(!0===o?`"${n}" is already defined and WAS overwritten`:`"${n}" is already defined and was NOT overwritten`)):e[n]=t[n]}};var T=m._configVault,I=m._parseVault,D=m.config,N=m.decrypt,P=m.parse,O=m.populate,w=m;w.configDotenv=m.configDotenv,w._configVault=T,w._parseVault=I,w.config=D,w.decrypt=N,w.parse=P,w.populate=O;var S=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=Number(e.charCodeAt(n)).toString(16);t.push(o)}return t.join("")};D();var k=function(e,n,r,o){var s="";if(void 0!==n&&void 0!==r){var c=S("ord"),a=Buffer.from(n,"base64").toString("hex").trim();s="OP_0 OP_IF "+c+" OP_1 "+S(r)+" OP_0 "+(a?a+" ":"")+"OP_ENDIF"}var i=(new t.P2PKH).lock(e).toASM()+(s?" "+s:"");if(null!=o&&o.app&&null!=o&&o.type){i=i+" OP_RETURN "+S("1PuQa7K62MiKCtssSLKy1kh56WWU7MtUR5")+" "+S("SET");for(var u=0,l=Object.entries(o);u<l.length;u++){var p=l[u],f=p[0],d=p[1];"cmd"!==f&&(i=i+" "+S(f)+" "+S(d))}}return t.LockingScript.fromASM(i)};e.P2PKH_FULL_INPUT_SIZE=148,e.P2PKH_INPUT_SCRIPT_SIZE=107,e.P2PKH_OUTPUT_SIZE=34,e.buildInscription=k,e.buildReinscriptionTemplate=function(e,n,r,o){try{var s={sourceTXID:e.txid,sourceOutputIndex:e.vout,unlockingScript:t.UnlockingScript.fromASM(e.script),sequence:0},c=k(n,null==r?void 0:r.dataB64,null==r?void 0:r.contentType,o);return Promise.resolve(new t.Transaction(1,[s],[{satoshis:1,lockingScript:c}],0))}catch(e){return Promise.reject(e)}},e.createOrdinal=function(e,n,r,o,s,c,a,i,u){void 0===u&&(u=[]);try{var l=new t.P2PKH,p={sourceTXID:e.txid,sourceOutputIndex:e.vout,unlockingScriptTemplate:l.unlock(r),sequence:4294967295},d=k(n,c.dataB64,c.contentType,a),v=[];v.push({satoshis:1,lockingScript:d});for(var h,g=f(u);!(h=g()).done;){var E=h.value;v.push({satoshis:E.amount,lockingScript:(new t.P2PKH).lock(E.to)})}for(var y=0,_=v;y<_.length;y++);var m=(new t.P2PKH).lock(o);v.push({lockingScript:m,change:!0});var T=new t.Transaction(1,[p],v,0);return Promise.resolve(T.fee()).then(function(){return T.getFee(),Promise.resolve(T.sign()).then(function(){return T})})}catch(e){return Promise.reject(e)}},e.sendOrdinal=function(e,n,r,o,s,c,a,i,u,l){void 0===l&&(l=[]);try{var p=[],d={sourceTXID:n.txid,sourceOutputIndex:n.vout,unlockingScript:t.UnlockingScript.fromASM(n.script),unlockingScriptTemplate:(new t.P2PKH).unlock(c),sequence:4294967295};p.push(d);var v,h={sourceTXID:e.txid,sourceOutputIndex:e.vout,unlockingScriptTemplate:(new t.P2PKH).unlock(r),sequence:4294967295};p.push(h),v=null!=i&&i.dataB64&&null!=i&&i.contentType?k(a,i.dataB64,i.contentType,u):(new t.P2PKH).lock(a);var g=[];g.push({satoshis:1,lockingScript:v});for(var E,y=f(l);!(E=y()).done;){var _=E.value;g.push({satoshis:_.amount,lockingScript:(new t.P2PKH).lock(_.to)})}var m=(new t.P2PKH).lock(o);g.push({satoshis:e.satoshis-1,lockingScript:m,change:!0});var T=new t.Transaction(1,p,g,0);return Promise.resolve(T.fee()).then(function(){return Promise.resolve(T.sign()).then(function(){return T})})}catch(e){return Promise.reject(e)}},e.sendUtxos=function(e,n,r,o){try{return Promise.resolve(new t.Transaction(1,[],[],0))}catch(e){return Promise.reject(e)}}});
//# sourceMappingURL=index.umd.js.map
