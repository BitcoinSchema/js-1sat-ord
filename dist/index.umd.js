!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@bsv/sdk"),require("sigma-protocol")):"function"==typeof define&&define.amd?define(["exports","@bsv/sdk","sigma-protocol"],n):n((e||self).js1SatOrd={},e.bsv,e.sigmaProtocol)}(this,function(e,n,t){function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function o(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return r(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,n){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},i(e,n)}var a=function(e){for(var n=[],t=0,r=e.length;t<r;t++){var o=Number(e.charCodeAt(t)).toString(16);n.push(o)}return n.join("")},c=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}var r,o;return o=e,(r=t).prototype=Object.create(o.prototype),r.prototype.constructor=r,i(r,o),t.prototype.lock=function(e,t,r,o){var i="";if(void 0!==t&&void 0!==r){var c=a("ord"),u=Buffer.from(t,"base64").toString("hex").trim();i="OP_0 OP_IF "+c+" OP_1 "+a(r)+" OP_0 "+(u?u+" ":"")+"OP_ENDIF"}var s=(i?i+" ":"")+(new n.P2PKH).lock(e).toASM();if(null!=o&&o.app&&null!=o&&o.type){s=s+" OP_RETURN "+a("1PuQa7K62MiKCtssSLKy1kh56WWU7MtUR5")+" "+a("SET");for(var l=0,f=Object.entries(o);l<f.length;l++){var p=f[l],v=p[0],d=p[1];"cmd"!==v&&(s=s+" "+a(v)+" "+a(d))}}return n.LockingScript.fromASM(s)},t}(n.P2PKH);e.buildReinscriptionTemplate=function(e,t,r,o){try{var i={sourceTransaction:n.Transaction.fromHex(e.rawTxHex),sourceOutputIndex:e.vout,sequence:0},a=(new c).lock(t,null==r?void 0:r.dataB64,null==r?void 0:r.contentType,o);return Promise.resolve(new n.Transaction(1,[i],[{satoshis:1,lockingScript:a}],0))}catch(e){return Promise.reject(e)}},e.createOrdinal=function(e,r,i,a,u,s,l,f,p){void 0===p&&(p=[]);try{var v=function(e){return Promise.resolve(x.fee(d)).then(function(){return Promise.resolve(x.sign()).then(function(){return x})})},d=new n.SatoshisPerKilobyte(s||10),h=e.map(function(e){return{sourceTransaction:n.Transaction.fromHex(e.rawTxHex),sourceOutputIndex:e.vout,unlockingScriptTemplate:(new n.P2PKH).unlock(i),sequence:4294967295}});u.length>100&&console.warn("Creating many inscriptions at once can be slow. Consider using multiple transactions instead.");for(var m,g=[],P=o(u);!(m=P()).done;){var y=m.value,k=(new c).lock(r,y.dataB64,y.contentType,l);g.push({satoshis:1,lockingScript:k})}for(var S,T=o(p);!(S=T()).done;){var w=S.value;g.push({satoshis:w.amount,lockingScript:(new n.P2PKH).lock(w.to)})}var b=(new n.P2PKH).lock(a);g.push({lockingScript:b,change:!0});var x=new n.Transaction(1,h,g,0),H=null==f?void 0:f.idKey,O=null==f?void 0:f.keyHost,K=function(){if(!H)return function(){if(O){var e=null==f?void 0:f.authToken,n=new t.Sigma(x);return function(t,r){try{var o=Promise.resolve(n.remoteSign(O,e)).then(function(e){x=e.signedTx})}catch(e){return r(e)}return o&&o.then?o.then(void 0,r):o}(0,function(e){throw console.log(e),new Error("Remote signing to "+O+" failed")})}}();var e=new t.Sigma(x).sign(H);x=e.signedTx}();return Promise.resolve(K&&K.then?K.then(v):v())}catch(e){return Promise.reject(e)}},e.sendUtxos=function(e,t,r,o,i){try{var a=new n.SatoshisPerKilobyte(o||10),c=e.map(function(e){return{sourceTransaction:n.Transaction.fromHex(e.rawTxHex),sourceOutputIndex:e.vout,unlockingScriptTemplate:(new n.P2PKH).unlock(t),sequence:4294967295}}),u=[],s={satoshis:i,lockingScript:(new n.P2PKH).lock(r)};u.push(s);var l=t.toAddress().toString(),f=(new n.P2PKH).lock(l);u.push({lockingScript:f,change:!0});var p=new n.Transaction(1,c,u,0);return Promise.resolve(p.fee(a)).then(function(){return Promise.resolve(p.sign()).then(function(){return p})})}catch(e){return Promise.reject(e)}},e.transferOrdinal=function(e,t,r,i,a,u,s,l,f,p){void 0===p&&(p=[]);try{for(var v,d=new n.SatoshisPerKilobyte(s||10),h=[],m=o(t);!(v=m()).done;){var g=v.value,P=n.Transaction.fromHex(g.rawTxHex),y={sourceTransaction:P,sourceOutputIndex:g.vout,unlockingScriptTemplate:(new c).unlock(a,void 0,void 0,void 0,n.LockingScript.fromASM(P.outputs[g.vout].lockingScript.toASM())),sequence:4294967295};h.push(y)}for(var k,S=o(e);!(k=S()).done;){var T=k.value,w={sourceTransaction:n.Transaction.fromHex(T.rawTxHex),sourceOutputIndex:T.vout,unlockingScriptTemplate:(new n.P2PKH).unlock(r),sequence:4294967295};h.push(w)}for(var b=[],x=o(t);!x().done;){var H;H=null!=l&&l.dataB64&&null!=l&&l.contentType?(new c).lock(u,l.dataB64,l.contentType,f):(new n.P2PKH).lock(u),b.push({satoshis:1,lockingScript:H})}for(var O,K=o(p);!(O=K()).done;){var j=O.value;b.push({satoshis:j.amount,lockingScript:(new n.P2PKH).lock(j.to)})}var A=(new n.P2PKH).lock(i);b.push({lockingScript:A,change:!0});var I=new n.Transaction(1,h,b,0);return Promise.resolve(I.fee(d)).then(function(){return Promise.resolve(I.sign()).then(function(){return I})})}catch(e){return Promise.reject(e)}}});
//# sourceMappingURL=index.umd.js.map
